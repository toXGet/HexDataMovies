#pragma checksum "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "b9894d03d7bb55e905b3acd183452b61697a1c3f"
// <auto-generated/>
#pragma warning disable 1591
namespace HexDataMovies.Client.Pages.Components
{
    #line hidden
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using HexDataMovies.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using HexDataMovies.Client.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using HexDataMovies.Shared.Entity;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "/home/saint/Documentos/HexDataMovies/Client/_Imports.razor"
using HexDataMovies.Client.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
using System;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
using System.Collections.Generic;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
using System.Threading.Tasks;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
using System.Timers;

#line default
#line hidden
#nullable disable
    public partial class CustomTypeaHead<TItem> : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<style type=\"text/css\">\n.blazored-typeahead {\n    position: relative;\n    width: 100%;\n    border: 1px solid #bfbfbf;\n    border-radius: 5px;\n}\n\n    .blazored-typeahead.valid.modified {\n        outline: none !important;\n        border: 1px solid #26b050;\n    }\n\n    .blazored-typeahead.invalid {\n        outline: none !important;\n        border: 1px solid red;\n    }\n\n.blazored-typeahead__controls {\n    position: relative;\n    cursor: text;\n    display: flex;\n}\n\n.blazored-typeahead__input {\n    flex: 1;\n    max-width: 100%;\n    border: none;\n    padding: .5rem;\n    border-radius: 5px;\n}\n\n.blazored-typeahead:focus-within {\n    box-shadow: 0 0 0 0.2rem rgba(38,143,255,.5);\n}\n\n.blazored-typeahead__input:focus {\n    outline: none;\n}\n\n.blazored-typeahead__input-multi:focus {\n    outline: none;\n    box-shadow: none;\n}\n\n.blazored-typeahead__input-hidden {\n    display: none;\n}\n\n.invalid {\n    border-color: red !important;\n}\n\n.blazored-typeahead__input-mask-wrapper {\n    display: flex;\n    width: 100%;\n}\n\n.blazored-typeahead__input-multiselect-wrapper {\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n    flex-wrap: wrap;\n}\n\n.blazored-typeahead__input-mask-wrapper--disabled {\n    background-color: #e9ecef;\n    cursor: not-allowed;\n    border-radius: 5px 0 0 5px;\n    color: grey;\n    min-height: 40px;\n}\n\n.blazored-typeahead__input-mask-wrapper--disabled:focus {\n    border: none;\n}\n\n.blazored-typeahead__input-mask {\n    display: flex;\n    align-items: center;\n    flex: 1;\n    border-radius: 5px 0 0 5px;\n    padding: .5rem;\n}\n\n.blazored-typeahead__input-mask:focus {\n    outline: none;\n}\n\n.blazored-typeahead__clear {\n    width: 40px;\n    display: flex;\n    padding: .5rem;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    color: #dbdbdb;\n}\n\n.blazored-typeahead__clear:hover {\n    color: #333333;\n}\n\n.blazored-typeahead__down-arrow path {\n    fill: #dbdbdb;\n}\n\n.blazored-typeahead__input-icon {\n    width: 40px;\n    display: flex;\n    border-radius: 0 5px 5px 0;\n    padding: .5rem;\n    cursor: pointer;\n    background: none;\n}\n\n.blazored-typeahead__input-icon:focus {\n    outline: none;\n    box-shadow: 0 0 0 0.2rem rgba(38,143,255,.5);\n}\n\n.blazored-typeahead__input-icon:hover {\n    background-color: #f5f5f5;\n}\n\n.blazored-typeahead__input-icon:hover .blazored-typeahead__down-arrow path {\n    fill: #333333;\n}\n\n.blazored-typeahead__input-icon--disabled, .blazored-typeahead__input-icon--disabled:hover {\n    background-color: #e9ecef;\n    cursor: not-allowed;\n}\n\n.blazored-typeahead__input-icon--disabled .blazored-typeahead__down-arrow path, .blazored-typeahead__input-icon--disabled:hover .blazored-typeahead__down-arrow path {\n    fill: #9c9c9c;\n}\n\n.blazored-typeahead__multi-value {\n    background-color: #dbdbdb;\n    display: flex;\n    align-items: center;\n    min-width: 0px;\n    box-sizing: border-box;\n    border-radius: 2px;\n    margin: .4rem 0 .4rem .4rem;\n}\n\n.blazored-typeahead__multi-value-label {\n    color: rgb(51, 51, 51);\n    font-size: 85%;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    box-sizing: border-box;\n    border-radius: 2px;\n    overflow: hidden;\n    padding: 3px 3px 3px 6px;\n}\n\n.blazored-typeahead__multi-value-clear {\n    -webkit-box-align: center;\n    align-items: center;\n    display: flex;\n    padding-left: 4px;\n    padding-right: 4px;\n    box-sizing: border-box;\n    border-radius: 2px;\n    background-color: transparent;\n    border: 0;\n    outline: none;\n}\n\n.blazored-typeahead__multi-value-clear:focus {\n    outline: none;\n}\n\n.blazored-typeahead__multi-value-clear:hover {\n    background-color: rgb(212, 212, 212);\n    color: rgb(222, 53, 11);\n}\n\n.blazored-typeahead__results {\n    position: absolute;\n    box-shadow: 0 5px 10px rgba(0,0,0,.2);\n    border: 1px solid #dbdbdb;\n    min-height: 2rem;\n    max-height: 30rem;\n    overflow-y: auto;\n    z-index: 10;\n    width: 100%;\n    background: #fff;\n}\n\n.blazored-typeahead__result,\n.blazored-typeahead__notfound,\n.blazored-typeahead__results-help-template,\n.blazored-typeahead__results-header,\n.blazored-typeahead__results-footer {\n    padding: .5rem;\n    border-top: 1px solid #fff;\n    border-bottom: 1px solid #fff;\n}\n\n.blazored-typeahead__selected-item {\n    background-color: #dbdbdb;\n}\n\n.blazored-typeahead__selected-item-highlighted {\n    background-color: #d3e2f2;\n}\n\n.blazored-typeahead__active-item,\n.blazored-typeahead__result:hover,\n.blazored-typeahead__result:focus {\n    background-color: #007bff;\n    border-top: 1px solid #007bff;\n    border-bottom: 1px solid #007bff;\n    color: #fff;\n    cursor: pointer;\n}\n\n.blazored-typeahead__loader {\n    width: 24px;\n    height: 24px;\n    background-color: #333;\n    border-radius: 100%;\n    -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;\n    animation: sk-scaleout 1.0s infinite ease-in-out;\n}\n</style>\n\n");
            __builder.OpenElement(1, "div");
            __builder.AddAttribute(2, "class", "blazored-typeahead");
            __builder.AddElementReferenceCapture(3, (__value) => {
#nullable restore
#line 250 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                                      typeahead = __value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.OpenElement(4, "div");
            __builder.AddAttribute(5, "class", "blazored-typeahead__controls");
            __builder.OpenElement(6, "input");
            __builder.AddAttribute(7, "class", "blazored-typeahead__input");
            __builder.AddAttribute(8, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 256 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                       ShowSuggestions

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(9, "type", "text");
            __builder.AddAttribute(10, "autocomplete", "off");
            __builder.AddAttribute(11, "placeholder", 
#nullable restore
#line 259 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                          Placeholder

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(12, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 254 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                          SearchText

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(13, "oninput", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => SearchText = __value, SearchText));
            __builder.SetUpdatesAttributeName("value");
            __builder.AddElementReferenceCapture(14, (__value) => {
#nullable restore
#line 252 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                     searchInput = __value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 261 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
     if (ShouldShowSuggestions())
    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(15, "div");
            __builder.AddAttribute(16, "class", "blazored-typeahead__results");
#nullable restore
#line 264 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
             foreach (var item in Suggestions)
            {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(17, "div");
            __builder.AddAttribute(18, "class", "blazored-typeahead__result" + " " + (
#nullable restore
#line 266 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                                                                    GetSelectedSuggestionClass(item)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(19, "tabindex", "0");
            __builder.AddAttribute(20, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 267 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                            () => SelectResult(item)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(21, "onkeyup", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.KeyboardEventArgs>(this, 
#nullable restore
#line 267 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                                                                 ((e) => HandleKeyUpOnSuggestion(e,item))

#line default
#line hidden
#nullable disable
            ));
            __builder.SetKey(
#nullable restore
#line 266 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                           item

#line default
#line hidden
#nullable disable
            );
#nullable restore
#line 268 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                     if (ResultTemplate != null)
                    {
                        

#line default
#line hidden
#nullable disable
            __builder.AddContent(22, 
#nullable restore
#line 270 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                         ResultTemplate(item)

#line default
#line hidden
#nullable disable
            );
#nullable restore
#line 270 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                                             
                    }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 273 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 275 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
    }
    else if (ShowNotFound())
    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(23, "div");
            __builder.AddAttribute(24, "class", "blazored-typeahead__results");
#nullable restore
#line 279 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
             if (NotFoundTemplate != null)
            {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(25, "div");
            __builder.AddAttribute(26, "class", "blazored-typeahead__notfound");
            __builder.AddContent(27, 
#nullable restore
#line 282 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
                     NotFoundTemplate

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 284 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
            }
            else
            {

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(28, "<div class=\"blazored-typeahead__notfound\">\n                    No Results Found\n                </div>");
#nullable restore
#line 290 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 292 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
    }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 295 "/home/saint/Documentos/HexDataMovies/Client/Pages/Components/CustomTypeaHead.razor"
      
    [Parameter] public string Placeholder { get; set; }
    [Parameter] public TItem Value { get; set; }
    [Parameter] public EventCallback<TItem> ValueChanged { get; set; }
    [Parameter] public Func<string, Task<IEnumerable<TItem>>> SearchMethod { get; set; }
    [Parameter] public RenderFragment NotFoundTemplate { get; set; }
    [Parameter] public RenderFragment<TItem> ResultTemplate { get; set; }
    [Parameter] public RenderFragment<TItem> SelectedTemplate { get; set; }
    [Parameter] public RenderFragment FooterTemplate { get; set; }
    [Parameter] public int MinimumLength { get; set; } = 1;
    [Parameter] public int Debounce { get; set; } = 300;
    [Parameter] public int MaximumSuggestions { get; set; } = 25;
    [Parameter] public bool DisplayClear { get; set; } = true;

    protected bool IsSearching { get; private set; } = false;
    protected bool IsShowingSuggestions { get; private set; } = false;
    protected bool IsShowingSearchbar { get; private set; } = true;
    protected bool IsShowingMask { get; private set; } = false;
    protected TItem[] Suggestions { get; set; } = new TItem[0];
    protected string SearchText
    {
        get => _searchText;
        set
        {
            _searchText = value;
            if (value.Length == 0)
            {
                _debounceTimer.Stop();
                Suggestions = new TItem[0];
            }
            else if (value.Length >= MinimumLength)
            {
                _debounceTimer.Stop();
                _debounceTimer.Start();
            }
        }
    }
    protected ElementReference searchInput;
    protected ElementReference typeahead;

    private Timer _debounceTimer;
    private string _searchText = string.Empty;

    protected override void OnInitialized()
    {
        if (SearchMethod == null)
        {
            throw new InvalidOperationException($"{GetType()} requires a {nameof(SearchMethod)} parameter.");
        }
        if (ResultTemplate == null)
        {
            throw new InvalidOperationException($"{GetType()} requires a {nameof(ResultTemplate)} parameter.");
        }

        _debounceTimer = new Timer();
        _debounceTimer.Interval = Debounce;
        _debounceTimer.AutoReset = false;
        _debounceTimer.Elapsed += Search;

        Initialize();
    }

    protected override void OnParametersSet()
    {
        Initialize();
    }

    private void Initialize()
    {
        IsShowingSuggestions = false;
        if (Value == null)
        {
            IsShowingMask = false;
            IsShowingSearchbar = true;
        }
        else
        {
            IsShowingSearchbar = false;
            IsShowingMask = true;
        }
    }

    protected void HandleClickOnMask()
    {
        IsShowingMask = false;
        IsShowingSearchbar = true;
    }

    protected async Task ShowMaximumSuggestions()
    {
        IsShowingSuggestions = !IsShowingSuggestions;
        if (IsShowingSuggestions)
        {
            SearchText = "";
            IsSearching = true;
            await InvokeAsync(StateHasChanged);
            Suggestions = (await SearchMethod?.Invoke(_searchText)).Take(MaximumSuggestions).ToArray();

            IsSearching = false;
            await InvokeAsync(StateHasChanged);
        }
    }

    protected void ShowSuggestions()
    {
        if (Suggestions.Any())
        {
            IsShowingSuggestions = true;
        }
    }

    protected async Task HandleKeyUpOnSuggestion(KeyboardEventArgs args, TItem item)
    {
        // Maybe on any key except Tab and Enter, continue the typing option.

        switch (args.Key)
        {
            case "Enter":
                await SelectResult(item);
                break;
            case "Escape":
            case "Backspace":
            case "Delete":
                Initialize();
                break;
            default:
                break;
        }
    }

    protected async Task HandleKeyUpOnShowMaximum(KeyboardEventArgs args)
    {
        if (args.Key == "Enter")
            await ShowMaximumSuggestions();
    }

    protected string GetSelectedSuggestionClass(TItem item)
    {
        if (Value == null)
            return null;
        if (Value.Equals(item))
            return "blazored-typeahead__result-selected";
        return null;
    }

    protected async void Search(Object source, ElapsedEventArgs e)
    {
        IsSearching = true;
        await InvokeAsync(StateHasChanged);
        Suggestions = (await SearchMethod?.Invoke(_searchText)).Take(MaximumSuggestions).ToArray();

        IsSearching = false;
        IsShowingSuggestions = true;
        await InvokeAsync(StateHasChanged);
    }

    protected async Task SelectResult(TItem item)
    {
        SearchText = "";
        await ValueChanged.InvokeAsync(item);
    }

    protected bool ShouldShowSuggestions()
    {
        return IsShowingSuggestions && Suggestions.Any();
    }

    private bool HasValidSearch => !string.IsNullOrWhiteSpace(SearchText) && SearchText.Length >= MinimumLength;

    private bool IsSearchingOrDebouncing => IsSearching || _debounceTimer.Enabled;

    protected bool ShowNotFound()
    {
        return IsShowingSuggestions &&
               HasValidSearch &&
               !IsSearchingOrDebouncing &&
               !Suggestions.Any();
    }

    protected void OnFocusOut(object sender, EventArgs e)
    {
        Initialize();
        InvokeAsync(StateHasChanged);
    }

    protected void OnEscape(object sender, EventArgs e)
    {
        Initialize();
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        _debounceTimer.Dispose();
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
